
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Reference Visualization</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0d1117;
            --box-bg: #161b22;
            --border: #30363d;
            --text: #c9d1d9;
            --stack: #79c0ff;
            --heap: #d2a8ff;
            --ptr: #2ea043;
            --highlight: #e3b341;
        }

        body {
            margin: 0; padding: 20px; background: var(--bg); color: var(--text);
            font-family: 'Inter', sans-serif; display: flex; flex-direction: column; align-items: center;
        }

        /* LAYOUT */
        .container {
            display: flex; width: 100%; max-width: 1000px; gap: 20px; margin-top: 30px; height: 500px;
        }

        /* CODE PANEL */
        .code-panel {
            flex: 1; background: var(--box-bg); border: 1px solid var(--border); border-radius: 8px;
            padding: 20px; font-family: 'Fira Code', monospace; font-size: 13px; line-height: 1.8;
        }
        .line { padding: 4px 8px; border-radius: 4px; border-left: 3px solid transparent; opacity: 0.6; transition: 0.3s; }
        .line.active { background: rgba(56, 139, 253, 0.15); border-left-color: #58a6ff; opacity: 1; color: white; font-weight: bold; }
        
        .kwd { color: #ff7b72; } .var { color: #79c0ff; } .str { color: #a5d6ff; } .prop { color: #d2a8ff; }

        /* MEMORY PANEL */
        .visualizer {
            flex: 1.5; display: flex; gap: 40px; position: relative;
        }
        .col {
            flex: 1; background: var(--box-bg); border: 1px solid var(--border); border-radius: 8px;
            padding: 15px; position: relative;
        }
        .col-head { text-align: center; font-size: 12px; font-weight: bold; color: #8b949e; margin-bottom: 20px; text-transform: uppercase; }

        /* STACK ITEMS */
        .stack-item {
            background: #21262d; border-left: 3px solid var(--stack); padding: 10px; margin-bottom: 20px;
            border-radius: 4px; font-family: 'Fira Code', monospace; font-size: 12px;
            display: flex; justify-content: space-between; opacity: 0; transform: translateX(-20px); transition: 0.5s;
        }
        .stack-item.show { opacity: 1; transform: translateX(0); }
        .ptr-val { color: var(--heap); font-weight: bold; }

        /* HEAP OBJECT */
        .heap-obj {
            background: #21262d; border: 2px dashed var(--heap); padding: 15px; border-radius: 8px;
            font-family: 'Fira Code', monospace; font-size: 12px; position: relative;
            opacity: 0; transform: scale(0.8); transition: 0.5s; margin-top: 50px;
        }
        .heap-obj.show { opacity: 1; transform: scale(1); }
        .addr { position: absolute; top: -10px; right: 10px; background: var(--heap); color: black; font-size: 10px; padding: 2px 5px; border-radius: 4px; font-weight: bold; }
        
        .prop-row { margin: 5px 0; color: #8b949e; }
        .val-span { color: #a5d6ff; font-weight: bold; transition: 0.3s; }
        .val-span.flash { background: var(--highlight); color: black; padding: 0 4px; }

        /* POINTERS */
        #svgLayer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        path { fill: none; stroke: var(--ptr); stroke-width: 2; transition: d 0.5s; }

        /* CONSOLE */
        .console {
            margin-top: 20px; width: 100%; max-width: 1000px; background: black; border: 1px solid #333;
            padding: 15px; font-family: 'Fira Code', monospace; font-size: 12px; color: #0f0; min-height: 80px;
        }

        /* BUTTON */
        .btn {
            margin-top: 20px; padding: 10px 30px; background: var(--ptr); border: none; color: white;
            font-weight: bold; border-radius: 6px; cursor: pointer; font-family: 'Inter';
        }
        .btn:hover { background: #26a641; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }

    </style>
</head>
<body>

    <h2 style="color:#58a6ff; margin-bottom:5px;">Shared Reference Visualizer</h2>
    <div style="font-size:12px; color:#8b949e;">Why changing userObj changes baseData</div>

    <div class="container">
        <div class="code-panel">
            <div class="line" id="l1"><span class="kwd">let</span> <span class="var">baseData</span> = { <span class="prop">from</span>: <span class="str">"hyd"</span>, <span class="prop">to</span>: <span class="str">"chn"</span> };</div>
            <div class="line" id="l2"></div>
            <div class="line" id="l3"><span class="kwd">let</span> <span class="var">userObj</span> = <span class="var">baseData</span>;</div>
            <div class="line" id="l4"></div>
            <div class="line" id="l5"><span class="var">userObj</span>.<span class="prop">from</span> = <span class="str">"secundarabad"</span>;</div>
            <div class="line" id="l6"></div>
            <div class="line" id="l7">console.log(<span class="var">baseData</span>);</div>
            <div class="line" id="l8">console.log(<span class="var">userObj</span>);</div>
        </div>

        <div class="visualizer">
            <div class="col">
                <div class="col-head">Stack</div>
                <div id="stack-container"></div>
            </div>
            <div class="col">
                <div class="col-head">Heap</div>
                <div id="heap-container"></div>
            </div>
            <svg id="svgLayer"></svg>
        </div>
    </div>

    <div class="console" id="console">
        > Console Output will appear here...
    </div>

    <button class="btn" onclick="nextStep()" id="btn">Step 1: Create baseData ▶</button>

    <script>
        let step = 0;
        const stackCont = document.getElementById('stack-container');
        const heapCont = document.getElementById('heap-container');
        const svg = document.getElementById('svgLayer');
        const consoleEl = document.getElementById('console');
        const btn = document.getElementById('btn');

        function highlight(id) {
            document.querySelectorAll('.line').forEach(l => l.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function drawPointer(sId, hId) {
            const s = document.getElementById(sId).getBoundingClientRect();
            const h = document.getElementById(hId).getBoundingClientRect();
            const c = document.querySelector('.visualizer').getBoundingClientRect();

            const x1 = s.right - c.left - 10;
            const y1 = s.top - c.top + 20;
            const x2 = h.left - c.left;
            const y2 = h.top - c.top + 40;

            const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
            path.setAttribute("d", `M ${x1} ${y1} C ${x1+50} ${y1}, ${x2-50} ${y2}, ${x2} ${y2}`);
            svg.appendChild(path);
        }

        function nextStep() {
            step++;
            if(step === 1) {
                // LINE 1: Create Object
                highlight('l1');
                btn.innerText = "Step 2: Copy Reference ▶";
                
                // Stack Item
                stackCont.innerHTML += `
                    <div class="stack-item show" id="s1">
                        <span>baseData</span>
                        <span class="ptr-val"><#101></span>
                    </div>`;
                
                // Heap Object
                heapCont.innerHTML += `
                    <div class="heap-obj show" id="h1">
                        <div class="addr">#101</div>
                        <div class="prop-row">from: <span class="val-span" id="val-from">"hyderabad"</span></div>
                        <div class="prop-row">to: <span class="val-span">"chennal"</span></div>
                    </div>`;

                setTimeout(() => drawPointer('s1', 'h1'), 200);

            } else if(step === 2) {
                // LINE 3: Copy Reference
                highlight('l3');
                btn.innerText = "Step 3: Mutate Object ▶";

                // New Stack Item pointing to SAME object
                stackCont.innerHTML += `
                    <div class="stack-item show" id="s2">
                        <span>userObj</span>
                        <span class="ptr-val"><#101></span>
                    </div>`;
                
                setTimeout(() => drawPointer('s2', 'h1'), 200);

            } else if(step === 3) {
                // LINE 5: Mutation
                highlight('l5');
                btn.innerText = "Step 4: Show Output ▶";

                const valSpan = document.getElementById('val-from');
                valSpan.innerText = '"secundarabad"';
                valSpan.classList.add('flash');
                
                // Flash the pointer to show path
                document.querySelectorAll('path').forEach(p => {
                    p.style.stroke = "#e3b341";
                    p.style.strokeWidth = "4";
                });
                
                setTimeout(() => {
                    valSpan.classList.remove('flash');
                    document.querySelectorAll('path').forEach(p => {
                        p.style.stroke = "#2ea043";
                        p.style.strokeWidth = "2";
                    });
                }, 800);

            } else if(step === 4) {
                // LINE 7 & 8: Console
                highlight('l7');
                document.getElementById('l8').classList.add('active');
                btn.innerText = "Done ✅";
                btn.disabled = true;

                consoleEl.innerHTML = `
> baseData: { from: "secundarabad", to: "chennal" }
> userObj:  { from: "secundarabad", to: "chennal" }
<br><span style="color:#e3b341">// Notice: Both changed because they point to #101</span>`;
            }
        }
    </script>
</body>
</html>

```